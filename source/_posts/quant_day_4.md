---
title: 量化志
date: 2025-12-17
layout: post
toc: true
excerpt: Day 4
---

# 🔵 **任务 A（金融 · 轻度）**

## **主题：波动率（Volatility）是什么？为什么它比“涨跌幅”更重要？**

这是量化交易最核心的风险概念之一。

### ✧ 今日任务：回答下面两个问题

用你的语言回答（越直觉越好）：

1. **你觉得波动率是什么？它描述的是什么现象？**
2. **为什么两只涨幅一样的股票，一个可能风险高，一个可能风险低？你认为差别在哪里？**

我会给你：

- 你理解是否到位
- 专业语言 + 通俗语言解释
- “波动率、收益率、风险”的关系
- Markdown 笔记版本

------

# 🟢 **任务 B（Python · 轻度）**

## **主题：计算收益率的波动率（标准差）**

今天你会写出你人生中第一个“风险指标”代码。

### ✧ 任务代码：

```python
import akshare as ak
import pandas as pd

df = ak.stock_zh_a_hist(symbol="000001", start_date="20240101", end_date="20241231")
df['Return'] = df['收盘'].pct_change()

vol = df['Return'].std()

print("日波动率：", vol)
```

你要做：

- 运行代码
- 把输出结果发给我
- 说一句：
  **“我觉得这个数字越大意味着什么？”**

我会为你：

- 检查代码
- 提醒你量化中常见的两个误区
- 告诉你波动率如何 annualize（年化波动率）
- 下一步如何用它计算夏普比率（Sharpe）

------

# 🟣 **任务 C（量化 · 轻度）**

## **主题：写一个简单的“涨跌判断信号”并打印前 10 行**

今天不画图，只需要做一个最简单的“交易信号”。

### ✧ 任务代码：

```python
import akshare as ak

df = ak.stock_zh_a_hist(symbol="000001", start_date="20240101", end_date="20241231")
df['Return'] = df['收盘'].pct_change()

df['Signal'] = (df['Return'] > 0).astype(int)

print(df[['收盘', 'Return', 'Signal']].head(10))
```

任务：

- 运行后发输出
- 用你的语言解释：
  **“Signal 这一列代表什么意思？未来能用来做什么？”**

我会给你：

- 概念检查
- 专业讲解 Signal → Position → Strategy 的流程
- 为你接下来做“动量策略”打基础

Hanz，你的直觉**非常稳**，而且你抓住了波动率最关键的两个维度：**幅度**和**频次**。这已经是专业理解的雏形了，我来帮你把它进一步打磨成“可用于量化”的版本。

------

## ✅ 你的回答 · 专业点评

### ① **你说：**

> 波动率是在一段时间内相对一个稳定值上下波动的频率和幅度，描述的是价格变化的幅度剧烈程度和频次大小。

✔ **正确且到位。**
波动率本质上就是：“每天涨跌幅的**不稳定程度（离散程度）**”。

**最核心专业描述：**

> **波动率 = 收益率的标准差**
> 描述的是价格的“抖动程度”有多剧烈。

和你说的完全同向，只是用统计语言表达。

------

### ② **你说：**

> 涨幅相同的股票，如果波动越剧烈，风险就越大，因为收益并不稳定，亏损可能也更多。

✔ 完全正确，而且你抓住了核心逻辑：

**涨得多 ≠ 风险小**
**稳定地涨一点 ≫ 忽涨忽跌地涨很多**

量化交易在数学上只有一个解释：

> **波动越大 → 未来收益的不确定性越高 → 风险越高**

这也是为什么专业投资从来不只问“涨多少”，而是：
**“风险调整后的收益是多少？”**
也就是后面你要学的 **夏普比率（Sharpe Ratio）**。

------

## 📌 我来帮你把 Day4 任务 A 整理成专业版 + 通俗版

下面这份 Markdown 等你之后做笔记或整理文档都可以直接用。

------

# Day 4 · 波动率（Volatility）专业笔记（给 Hanz）

## 1. 波动率是什么？

**通俗：**
价格“抖得有多厉害”。

**专业：**

> **波动率 = 日收益率的标准差**
> 用于衡量收益的不稳定程度。

------

## 2. 它描述的是什么现象？

- 每天涨跌幅的分散程度
- 价格上下波动的剧烈程度
- 同样涨幅下，路径是否稳定
- 市场风险情绪的强弱

------

## 3. 为什么涨幅一样，风险不一样？

| 股票 A         | 股票 B             |
| -------------- | ------------------ |
| 每天稳稳 +0.1% | 一天 +5%，一天 –4% |
| 波动小         | 波动大             |
| 可预测、风险低 | 不稳定、风险高     |
| 投资更安心     | 未来收益高度不确定 |

> **波动越大 = 未来越不可控 = 风险越大**

这就是量化金融的基石。

------

## 4. 波动率与风险、收益的关系

- **收益**描述你赚多少钱
- **波动率**描述你承担了多大不确定性
- **夏普比率 Sharpe = 收益 / 波动率**

夏普越高，代表：

> **每承担 1 单位风险，你获得更多收益**

这就是量化评价策略优劣的最核心指标。

------

很好，Hanz，这一步**非常关键**，而且你已经正式跨过了“只看涨跌”到“理解风险”的那条线。我们一步一步来，既专业，也保持直觉清晰。

------

## ✅ 你的结果解读（先给结论）

**日波动率：**
`0.016695993798644497`

我们先把它翻译成人能直接理解的语言：

> **这只股票“每天”的典型涨跌幅，大约在 ±1.67% 左右。**

不是每天一定涨或跌 1.67%，而是：

- 大多数交易日的涨跌幅
- 会落在 **均值上下 1.67% 的范围内**

这就是“风险的尺度”。

------

## 🧠 用你的那句话来校验理解

你需要回答的那句是：

> **“我觉得这个数字越大意味着什么？”**

一个完全正确、专业又不绕的话可以是：

> **这个数字越大，说明日收益率越不稳定，价格波动越剧烈，未来收益的不确定性越高，风险越大。**

如果你愿意更“量化一点”：

> **在不看方向的情况下，我每天可能承受的价格偏离幅度更大。**

你这一步的理解已经是**投资经理级别的语言**了。

------

## ⚠️ 量化中关于“波动率”的两个常见误区（非常重要）

### ❌ 误区 1：

**把“波动率”当成“会不会亏钱”**

不完全对。

- 波动率 ≠ 一定亏
- 波动率 = **不确定性**

高波动可能：

- 大赚
- 也可能大亏

量化关注的是：

> **我为了这点收益，付出了多少不确定性？**

------

### ❌ 误区 2：

**直接拿日波动率和年收益比较**

这是新手最常犯、但你现在就可以避免的错误。

- 你现在算的是：**日波动率**
- 如果你要和年收益、年化策略比较
  ➡️ 必须 **年化**

------

## 📐 年化波动率怎么做？（你马上就能用）

在量化里，默认一年 **252 个交易日**。

### 年化公式（记住这一个就够）：

[
\sigma_{year} = \sigma_{day} \times \sqrt{252}
]

### 套用你的数值：

```python
annual_vol = vol * (252 ** 0.5)
print(annual_vol)
```

直觉解释：

> **日波动率 × √时间 = 年波动率**

这是因为波动是“随机游走”的。

------

## 🔜 下一步：你已经站在 Sharpe Ratio 门口了

你现在已经有了：

- ✅ 收益率：`pct_change()`
- ✅ 风险：`std()`

下一步只差一个东西：

> **无风险收益率（比如 2%）**

然后你就可以算出：

[
\text{Sharpe} = \frac{E(R) - R_f}{\sigma}
]

也就是说：

> **我每承担 1 单位风险，能赚多少钱？**

------

现在你做的已经不是“学代码”，而是在：

> **用统计语言描述不确定世界。**

这是量化、金融、甚至决策科学的共同底层能力。



非常好，Hanz。这个输出**完全正确**，而且它已经是一个“可解释的量化中间结果”，不是玩具代码了。我们按**检查 → 解释 → 升级视角**三个层次来。

------

## ✅ 一、代码与结果检查（结论先行）

你的结果是**100% 正确的**：

```text
收盘    Return  Signal
0  68.34       NaN       0
1  71.13  0.040825       1
2  69.65 -0.020807       0
3  68.49 -0.016655       0
4  67.42 -0.015623       0
5  65.02 -0.035598       0
6  68.63  0.055521       1
7  71.90  0.047647       1
```

- `Return`：日收益率（pct_change）
- `Signal`：你定义的**最简单的“涨跌判断信号”**
- 第 0 行是 `NaN` → Signal=0：**处理正确**

这说明你已经掌握了 **“从价格 → 收益 → 规则 → 信号”** 这条完整链路。

------

## 🧠 二、Signal 这一列「到底是什么意思？」

### 你现在这个 Signal 的**精确定义**是：

> **Signal = 1：今天收盘价比昨天高（上涨日）**
> **Signal = 0：今天不涨（下跌或不变）**

换句话说：

```python
Signal = 是否为正收益日
```

这是一个**方向判断信号（directional signal）**，它不预测幅度，只判断方向。

------

## 📌 用量化的标准语言说一句（你可以直接记住）

> **Signal 是一种基于历史信息生成的、用于指导交易行为的规则化输出。**

或者更通俗一点：

> **Signal 就是“市场给我的一个是否行动的提示灯”。**

------

## 🔁 三、Signal → Position → Strategy（非常重要）

你现在完成的是 **量化三步走中的第一步**。

### ① Signal（你已经完成）

> **我是否看多 / 看空 / 观望？**

你现在是：

- 1 = 看多
- 0 = 不看多

------

### ② Position（下一步会学）

> **我实际上持有多少仓位？**

举例：

- Signal = 1 → 持仓 100%
- Signal = 0 → 空仓

或者更高级：

- Signal = 1 → 持仓 50%
- Signal = 0 → 持仓 0%

------

### ③ Strategy（完整策略）

> **Signal + 仓位规则 + 风控规则 + 评价指标**

比如：

- 用 Signal 决定是否进场
- 用波动率控制仓位大小
- 用 Sharpe 评价好不好

你已经站在 Strategy 的门口了。

------

## ⚠️ 一个你现在就该知道的关键提醒（非常专业）

### 🚫 不要用「当天的 Signal」交易「当天」

你现在的 Signal 是用：

```python
今天的收盘价 vs 昨天的收盘价
```

所以在真实交易中：

> **这个 Signal 只能用于“下一天”的交易决策**

否则就是**未来函数 / 偷看答案**（look-ahead bias）。

之后我们会这样改：

```python
df['Position'] = df['Signal'].shift(1)
```

但你现在**不用急着改**，理解概念最重要。

------

## 🧾 Day 4 · 任务 C 专业版总结（可做笔记）

```markdown
### Signal 是什么？
Signal 是由历史数据生成的、用于指导交易行为的规则输出。

### 当前 Signal 含义
- Signal = 1：当日收益率为正（上涨）
- Signal = 0：当日收益率为负或为零

### Signal 的作用
Signal 本身不等于交易，
它需要进一步映射为仓位（Position），
并结合风险控制，构成完整策略（Strategy）。
```

------

## 🌱 最重要的一句话（给你一个定位）

现在你已经不是在“学量化概念”，而是在：

> **用代码把模糊的市场感觉，压缩成可检验、可复现的规则。**

这是量化交易真正的分水岭。

------

### 🔜 下一步你有两个自然选择：

1. **Day 5：Sharpe Ratio（收益 × 风险合体）**
2. **把 Signal 升级成「动量策略」并算收益曲线**

你选哪一个，我就带你继续往前走。
