---
title: 量化志
date: 2025-11-14
layout: post
toc: true
excerpt: Day 2
---

# 🌟 **Day 2 · 轻度三选一任务**

# 🔵 **任务 A（金融 · 轻度）**

## **主题：利率 vs 折现率——它们到底是什么关系？**

✧ 任务内容（10 分钟以内）

只需要回答“两个小问题”，用你的语言表达（专业不专业都没关系）：

1. **你觉得利率（interest rate）和折现率（discount rate）有什么不同？**
2. **折现率为什么通常比无风险利率更高？**

✧ 我会给你：

- 判断你的理解是否到位
- 纠正细微偏差
- 给你一个“最直觉 + 最专业”的对比图
- 更新你的知识库句子（Markdown）

------

# 🟢 **任务 B（Python · 轻度）**

## **主题：写出人生中第一个折现函数**

今天我们写一个超简单、可运行的折现函数（未来会在你的 DCF 和 NPV 中使用）。

✧ 任务内容

请运行并理解以下代码，并告诉我“输出了什么”：

```python
def discount(FV, r, t):
    PV = FV / ((1 + r) ** t)
    return PV

print(discount(100, 0.10, 1))  # 1 年后的 100，以 10% 折现
print(discount(100, 0.10, 3))  # 3 年后的 100，以 10% 折现
```

✧ 你只需要：

- 给我输出结果
- 说一句：“我觉得这个函数在现实中能用在哪些场景？”

✧ 我会：

- 检查你的理解
- 帮你用专业语言润色
- 给你更好用的折现工具函数
- 教你把它扩展成“多期 DCF 版本”

------

# 🟣 **任务 C（量化 · 轻度）**

## **主题：计算 000001 的 5 日均线（MA5）**

均线是做趋势、动量策略最基本的指标之一。
 你只需要计算 MA5，不需要画图。

✧ 任务代码：

```python
import akshare as ak

df = ak.stock_zh_a_hist(symbol="000001", start_date="20240101", end_date="20241231")

df['MA5'] = df['收盘'].rolling(5).mean()

print(df[['收盘', 'MA5']].head(10))
```

✧ 你要做的：

- 发给我输出（或前几行截图）
- 用你的话解释一句：
   **“我觉得 MA5 能表达股票的什么走势信息？”**

✧ 我会：

- 检查你的代码
- 判断你的概念是否准确
- 告诉你 MA5 在量化策略中的专业用途
- 进一步引导你进入动量策略

------

# 🌟 **Day 2 总结：三条线路**

| 路线   | 内容           | 时间    | 输出        |
| ------ | -------------- | ------- | ----------- |
| 金融   | 利率 vs 折现率 | 10 分钟 | 概念理解    |
| Python | 折现函数       | 10 分钟 | 可运行代码  |
| 量化   | MA5 计算       | 10 分钟 | 代码 + 理解 |

------

# 🔵 任务 A：利率 vs 折现率

你的表述已经很接近本质了，而且思路是完全对的。我帮你把你的理解逐步梳理，让你看到哪些地方已经非常扎实，哪些地方可以再补一刀，让概念更专业、也更稳定。你现在等于是在说：

- **利率** → 只描述“钱数量的增长速度”，但它本身不包含风险、时间价值、机会成本。
- **折现率** → 把未来的钱换算成现在的价值，需要综合考虑：
   *时间价值（购买力下降） + 风险溢价 + 机会成本*。
- 真正的投资判断应该是：
   **未来收益（折现回来） − 当前成本**。

这一套逻辑完全正确，已经形成了“DCF 的基本框架”。

------

### ✔ 利率（Interest Rate）

反映的是资金在时间上的“名义增长速度”。
 它只是告诉你：

> 把 100 元存进去，明年变成多少？

它本身不包含：风险、购买力变化、替代投资收益。

### ✔ 折现率（Discount Rate）

折现率是一个“要求的回报率”，它包含：

- **时间价值**（通胀导致购买力下降）
- **风险溢价**（未来不确定性更高）
- **机会成本**（你放弃的其他投资能给你多少）

本质上，折现率是在问：

> **如果我要承担这笔投资的风险，我至少要求多少回报？**

越风险的项目 → 折现率越高 → 未来现金流价值越低。

⚡ **3. 最关键的一句总结（帮你存档的那句）**

> **利率描述资金的自然增长速度，而折现率衡量未来收益折算到今天时“必须满足的最低回报要求”。折现率通常高于无风险利率，因为它额外包含风险溢价和机会成本。**

这句话你之后写 DCF 的文章、制作 PPT，都能直接用。

------

🌈 **4. 最后问你一个小问题（确认你的理解已经稳了）**

**你觉得：折现率和无风险利率之间，一般相差的那一段叫什么？**

完全正确，就是 **风险溢价（Risk Premium）**。

你的理解已经稳定地踩在专业框架上了，而且你是在“自然推导”出答案，而不是死记，这非常好。

我帮你把这个点再往前推一步，让你的金融直觉更有力量：

------

⭐ **折现率 = 无风险利率 + 风险溢价 + 其他成本**

典型结构如下：

```
折现率 = 无风险利率（时间价值）
       + 风险溢价（项目不确定性）
       + 机会成本（资本本可以去别处获得的收益）
```

你答的“风险溢价”，就是折现率比无风险利率高的那一块核心差额。

------

📘 把它变成一句能反复使用的知识句（你可直接存档）

> **折现率之所以比无风险利率高，就是因为它加上了“风险溢价”：承担不确定性所要求的额外补偿。**

如果你未来做股票、债券、量化策略，看到关键字：

- equity risk premium
- credit spread
- liquidity premium
- default premium

这些全部本质都属于“风险溢价”，只不过来源不同。

Hanz，这个问题问得非常关键，而且是很多初学者、甚至一些从业者常常混淆的部分。你现在的敏感度非常好，我们把这三个概念彻底拆开 —— **风险溢价、通胀、机会成本** —— 一次讲清，让你建立“清晰又专业”的金融直觉。

我尽量保持我们之前的风格：**正式、清晰、鼓励、带一点前瞻性**。

------

### ✅ **一、机会成本是否包含在风险溢价中？**

**严格金融定义：不包含。**
 **直觉上容易混在一起，但本质不同。**

✔ 风险溢价（Risk Premium）是什么？

它是你为了“承担风险”而额外要求的回报。

- 风险越大 → 风险溢价越高
- 是对不确定性的补偿
- 与“其他投资可以赚多少”无关

✔ 机会成本（Opportunity Cost）是什么？

它指的是：

> 如果你不投这个项目，你的资金在“其他安全、有稳定回报的地方”，可以赚多少？

常用的例子包括：

- 投入此项目 ≠ 投入国债
- 投入此项目 ≠ 投入指数基金
- 投入此项目 ≠ 投入储蓄或货币基金

它是 **你放弃了的那条路能给你的确定回报**，不是风险本身。

⭐ **因此：机会成本 ≠ 风险溢价。**

但它俩都会影响“你要求的折现率”。

------

⭐ **二、折现率的组成（专业版）**

最清晰的表达是：

```
折现率 = 无风险利率 + 风险溢价 + 其他溢价（如流动性溢价）
```

而“机会成本”通常体现在你选择“比无风险更高的替代投资时”，自然提高你的 **最低可接受回报率**。

但它不是风险的一部分，而是你可选择的“替代资产回报”。

------

⭐ **三、风险溢价是否包含通胀？**

这点容易混淆，我们彻底讲清：

✔ 风险溢价 **不包含** 通胀。

风险溢价只补偿你承担风险。

✔ 通胀属于「无风险利率」的一部分。

无风险利率（如国债收益率）本身就由两部分组成：

```
无风险利率 = 实际利率 + 通胀预期
```

所以：

- 通胀 **不算风险溢价**
- 通胀 **也不算机会成本**
- 通胀 **属于基础利率的一部分**

------

🎯 **四、帮你整理成一句极专业又通俗易懂的话（可存档）**

> **折现率 = 无风险利率（含通胀） + 风险溢价（承担风险的补偿）+ 机会成本（你放弃的替代资产收益）。
>  风险溢价不含通胀，机会成本也不属于风险溢价。**

这是你的 Day2 金融核心句子，未来写 DCF、做估值时会频繁使用。

------

### 🎯 **为什么“无风险利率”里会包含通胀？**

因为：

> **无风险利率 = 投资者把钱借给政府时，政府必须给你的“最低补偿”。
>  这个最低补偿，必须至少覆盖通胀，否则你亏了。**

政府发行国债时，会根据市场的预期通胀自动反映到国债收益率中。
 你可以把它理解为：
 **政府必须付你“购买力损失”的钱 + 一点点真正的收益。**

所以，无风险利率通常由两部分构成：

```
无风险利率 = 实际回报（Real Rate） + 通胀预期（Inflation Expectation）
```

里面不是“没有通胀”的利率，而是把通胀算进去后的“安全收益”。

------

🌈 **举例（最容易理解的场景）**

假设：

- 现在通胀 3%
- 你把 100 元借给政府 1 年
- 如果政府只还你 100 元 → 你实际是亏钱的（购买力下降）

所以政府必须付你：

- **弥补通胀的 3%**
- **再给你一点点真正的利息（比如 1%）**

这样你才不亏。

于是国债利率可能是：

```
无风险利率 = 通胀 3% + 实际利率 1% = 4%
```

------

👍 **再换一种非常生活的比喻**

你把钱借给政府，相当于说：

> “我把钱的使用权给你一年，但一年后你要保证我不亏，还要给一点点奖励。”

而“保证我不亏”最基本的，就是抵消通胀。

------

⭐ **再给你一个真实世界的例子（美国 TIPS）**

美国有一种债叫：

**TIPS = Treasury Inflation-Protected Securities（抗通胀国债）**

- 它的利率只包含“实际利率”
- 通胀部分由政府另行补偿（本金跟着 CPI 自动增加）

普通国债（Nominal Treasury Yield）＝包含通胀的利率
 TIPS（Real Yield）＝不包含通胀的利率

所以我们常常用：

```
名义国债利率（包含通胀） − TIPS 实际利率（不含通胀）
= 市场预期的通胀率
```

这就是“无风险利率包含通胀”的最专业证据。

------

💡 **一句重新总结（你可以存档）：**

> **无风险利率反映的是投资者对“未来购买力损失”的补偿，所以它自然包含通胀预期。政府债券收益率会自动把通胀折进利率里，因此无风险利率 = 实际利率 + 通胀预期。**

**——既然政府必须弥补通胀，那“通胀这部分利率”到底是谁说了算？依据什么来定？**

我来一步一步带你把这件事彻底看清楚，让逻辑完全闭合。

------

✅ 一、通胀补偿“不是政府拍脑袋决定的”

它来自 **市场对未来通胀的共同预期**

国债利率是 *市场决定* 的，不是政府随意设定的。
 政府发行国债，就像把债券放到市场上拍卖：

- 投资者（银行、机构、保险公司、基金）去抢
- 价格越高 → 利率越低
- 价格越低 → 利率越高

最后形成一个市场认可的结果。

这个结果里就隐含了：

> **市场认为未来一年（或三年、十年）的通胀大概是多少。**

------

🌟 **二、通胀补偿 = 市场预期通胀（Expected Inflation）**

预期通胀怎么得来？
 来自：**投资者对未来物价的判断**。

他们用的信息包括：

- CPI 最近上涨速度
- PPI 的变化
- 工资增长速度
- 经济增长率
- 原油价格
- 央行货币政策
- 未来的通胀模型预测
- 交易员的定价（最关键）

换句话说：

> **“通胀补偿”是无数投资者、机构、央行、模型共同博弈出来的市场定价。**

------

🎯 **三、如何“测量”这一部分？市场有一个公式：**

这个公式在专业金融里非常常用：

```
名义国债收益率（包含通胀）
= 实际收益率（不含通胀） + 通胀预期
```

我们可以直接从市场价格反推：

```
通胀预期 = 名义国债收益率 − TIPS 实际收益率
```

例如（假设美国的情况）：

- 10 年期国债（名义）：4.5%
- 10 年期 TIPS（实际）：1.8%

则：

```
通胀预期 = 4.5% - 1.8% = 2.7%
```

这 2.7% 就是市场认为未来十年平均通胀。

------

💡 **四、再用一个生活比喻让你完全理解**

你把钱借给政府一年。

如果所有投资者都认为：

- 明年物价会涨 **5%**

那么他们就会和政府“讨价还价”，集体要求：

> “你需要至少给我 5% 的补偿，否则我现实中亏购买力。”

投资者只要觉得利率太低，就不会买，国债价格会掉，收益率就会被动升高。

这就是为什么无风险利率“必须”包含通胀。

------

⭐ **五、一句非常专业但很好懂的总结（你可以存档）：**

> **无风险利率中的“通胀补偿”不是人为设定，而是市场根据供需、投资者预期、宏观数据共同形成的价格结果。它等于名义国债收益率与实际收益率（TIPS）之间的差额。**

🎯 **当通胀预期变化时，名义国债收益率（名义利率）如何变化？**

因为 **折现率的基础是名义无风险利率**，而名义无风险利率每天都在随市场变化。
 所以我们关心的是：

> **通胀预期上升或下降，会如何推动 \*名义收益率本身\* 的调整？**

下面我把整个逻辑再收束成一个非常清晰的框架，让你不再混淆“实际利率”“预期通胀”“名义利率”这些概念。

------

✅ **1. 完整的三层结构（非常重要）**

国债收益率（名义利率） = 实际利率 + 市场预期通胀

```
Nominal Yield = Real Yield + Expected Inflation
```

其中：

- **实际利率（Real Yield）**：不含通胀的真实回报
- **预期通胀（Expected Inflation）**：市场认为未来物价平均上涨多少
- **名义利率（Nominal Yield）**：投资者实际拿到的、包含通胀的利率

折现率的基础就是“名义国债利率”，不是实际利率。

------

⭐ **2. 关键：名义收益率不是固定的，是市场交易价格推出来的**

你刚才的推理里，假设“名义利率不变”，所以得到了错误的结果。

但现实金融市场中：
 **名义利率每天随市场交易自动变化。**

- 通胀预期上升 → 名义利率会被动变高
- 通胀预期下降 → 名义利率会被动变低

因为债券价格会调整。

------

⭐ **3. 所以当我问你“通胀预期上升会怎样？”**

实际上在问：

> **名义无风险利率会如何调整？**

答案是：
 **通胀预期上升 → 名义国债收益率上升。**

原因是：
 投资者会要求更高的利率来弥补预期中的购买力损失。

------

🎯 再用一句完全确定的理解（你可以存档）：

> **名义国债利率会随着市场对未来通胀的预期变化而动态调整。当预期通胀上升，国债价格下降，名义利率上升；预期通胀下降，则利率下行。**

**如果未来几年通胀预期下降，比如从 3% 降到 1%，名义国债利率会怎样变化？为什么？**

你说：

> 名义国债利率会下降。
>  本质上这是政府和市场协商的结果，由于通胀率不高，所以在保证实际利率的情况下，通胀补偿部分会下降，总的名义国债利率会下降。

这句话的逻辑链条是 **完全成立的**：

- 通胀预期下降 → 投资者不再需要那么多通胀补偿
- 无风险利率中的“通胀补偿项”被动下降
- 名义国债利率整体下降

你已经能够把“通胀补偿 + 实际利率 + 市场定价”这三者真正串联起来，这说明你对利率体系的理解已经非常接近从业者级别。

------

✔ 我帮你润色成**更专业、更贴近市场实际的版本**（不改变你的意思）

> **当预期通胀下降时，投资者对通胀补偿的需求降低，国债的名义收益率随之下行。国债价格会上升，收益率下降，最终在市场供需中形成新的均衡利率。**

核心点就在一句话：

> **通胀预期下降 → 名义利率下降。**

你已经完全掌握。

------

🎯 你现在拥有“完整利率体系”的清晰图谱

你已经把以下逻辑全部打通了：

1. **名义利率 = 实际利率 + 通胀预期**
2. **通胀预期由市场定价（不是政府拍脑袋）**
3. **通胀预期变动 → 国债价格变动 → 名义利率变动**
4. **折现率必须以名义无风险利率为基准**
5. **风险溢价 ≠ 机会成本 ≠ 通胀补偿**（这一步你也已经完全掌握）

你现在的理解已经超越初学者、达到“投资从业者入门的金融直觉”。

------

# 🟢 任务 B：折现函数

做得非常好。你已经成功跑出了你人生中的第一个折现函数，而且结果完全正确。

我们来做一次**正式、清晰、专业的检查 + 升级**。

✅ **1. 输出检查（正确）**

你的结果：

```
90.9090909090909
75.13148009015775
```

解释：

- **1 年后 100 元**，以 10% 折现：
   → 现在价值约 **90.91 元**
- **3 年后 100 元**，以 10% 折现：
   → 现在价值约 **75.13 元**

你的理解完全 correct。

------

⭐ **2. 你说 “可以用来评估投资是否值得”——完全正确**

而且你已经踩中了折现的核心思维：

> **折现的意义，就是把未来的钱换算成现在的钱，然后和成本比较，判断投资是否划算。**

这是整个金融估值的底层逻辑。

我帮你补一句更专业、可以存档的表达：

> **折现函数的作用是将未来现金流转换为现值，用以判断投资能否产生超出资本成本的价值，是所有估值模型（NPV、DCF）的基础。**

------

🎯 **3. 我帮你做一次“升级版理解”**

你刚才运行的是一个：

### ✔ **单期折现函数（Single-period Discounting）**

现实中你可能会用它：

- 计算一年后的分红现在值
- 按风险折现某个项目的未来收益
- 判断“预期收益折回来是否大于投入成本”
- 估值债券的现金流
- 做量化策略的收益比较（如风险调整后的回报）

你已经完成了从“听说折现”到“亲手折现”的跃迁。

------

### ✔ DCF 多期版本

🌟 **4. 我帮你把这个函数升级成 DCF 多期版本（你可以先看，不用写）**

```python
def dcf(cashflows, r):
    PV = 0
    for t, cf in enumerate(cashflows, start=1): # enumerate 给项目编号, start=1从1开始
        PV += cf / ((1 + r) ** t)
    return PV

print(dcf([30, 40, 50], 0.10))
```

这个版本可以折现多期现金流，是 DCF（Discounted Cash Flow）的核心。

你未来会真正做企业估值、项目估值、量化回测时都会用它。

🌤 如果你愿意，我可以进一步讲：

- 为什么多期 DCF 一定要用 enumerate
- 如何把 DCF 扩展成 "带增长率的现金流"
- 如何用 Python 自动折现企业五年、十年现金流
- 如何用 pandas 做一个可复用的折现表格

------

✨ **5. 现在我来问你一个非常关键的小问题，让你真正吃透折现：**

❓ 为什么“3 年后的 100 元折现值”会比“1 年后的 100 元折现值”更低？

你可以用你自己的语言回答——
 我只需要一句话，我来帮你检查你的理解是否已经完全稳定。

你的回答非常到位，Hanz，而且已经抓住了折现的核心原理。
 我帮你把你的话，稍微调整成更严谨、更专业的版本，同时保持你那种清晰的直觉。

------

🌟 **你的理解（正确）：**

> 时间越长，复利越强，所以未来的同一笔钱，在今天的价值更低。

这是折现的本质。

------

✔ **我帮你升级成专业表达（可存档版）**

> **折现值随时间增长而下降，因为资金具有时间价值：越远的未来需要用更高次数的复利折回到今天，因此未来越久的同额现金流，其现值越低。**

把你自己的直觉换算成专业语言，就是这句话。

------

🎯 **你现在已经完全吃透了折现逻辑 · Day2（金融任务）完成**

你已经掌握：

- 现值 vs 未来值
- 利率 vs 折现率
- 风险溢价 vs 机会成本
- 无风险利率包含通胀
- 折现函数（单期版本）
- 多期 DCF 的基础结构
- “越远的未来现金流折现值越低”的根本原因

你的整个 Day 2 金融体系已经形成闭环，表现非常好。

# 🟣 任务 C：5日均线

Hanz，你的理解非常扎实，而且表达得清晰、准确、专业。
 我来帮你做一次完整的检查 + 提升，让你的量化直觉直接进入「专业级」。

------

✅ **1. 输出检查：完全正确**

你的结果：

```
   收盘    MA5
0  9.21    NaN
1  9.20    NaN
2  9.11    NaN
3  9.27    NaN
4  9.15  9.188
5  9.18  9.182
6  9.09  9.160
7  9.17  9.172
8  9.19  9.156
9  9.21  9.168
```

从第 5 行（索引 4）开始出现 MA5，因为要有 5 天的数据。

你的代码没有问题，理解也非常好。

------

🌟 **2. 你的解释（准确）**

你说：

> MA5 能表达最近 5 天的平均价格。滚动平均可以呈现趋势、减少突变影响，同时保持一定的敏感性。

这句话完全正确，而且已经体现出你对“平滑 vs 反应速度”的理解。

------

⭐ 我帮你升级成专业量化语言（未来可以直接放进你的笔记）

> **MA5 是对过去 5 个交易日收盘价的简单移动平均，用于平滑短期价格波动，捕捉短期趋势方向，并减少噪声干扰。它既具有一定稳定性，又保留对当前行情的敏感度，是趋势类和动量类策略中最基础的指标之一。**

你写 MA 系列指标时都可以用这个句子。

------

### 📈 **MA5 在量化策略中的专业用途（非常重要）**

MA5 是一个极短周期均线，它的用途有：

✔ **（1）判断短期趋势方向**

- MA5 上升 → 短线偏多
- MA5 下降 → 短线偏空

✔ **（2）捕捉短期动量**

短线动量策略常用 MA5/MA10/MA20 作为判断标准。

✔ **（3）做均线系统（交叉策略）**

比如：

- MA5 上穿 MA10 → 短期买点
- MA5 下穿 MA10 → 短期卖点

✔ **（4）做趋势过滤器**

只在 MA5 上方做多，减少噪声。

✔ **（5）用作基础的信号平滑器**

很多高频、日内策略都在原始信号上加 MA 滤波。

------

🎯 **4. 用一句通俗解释帮助你更直观记住 MA5**

> MA5 像是“过去一周股价的平均体温”。
>  单天的剧烈波动不影响整体判断，但如果几天持续偏高或偏低，就能看出趋势方向。

------

🌤 你的 Day 2 · 量化任务完成得非常漂亮。

Day2（A + B + C）你全部完成，理解稳固，表达专业，有逻辑有直觉。这已经是一个非常优秀的学习状态了。

------

💬 接下来你想怎么继续？

你可以从以下三条中选一：

① **进入 Day 3（量化核心：均线策略、突破策略、收益风险概念）**

② **继续做 MA10 / MA20 / 多均线交叉任务（动量策略入门）**

③ **我帮你整理 Day1 + Day2 的全套 Markdown 笔记结构**

你想选哪一个？

Hanz，5 日均线的英文写法非常固定，也很常用，我给你最标准、专业的表达方式。

------

✅ **5 日均线的英文**

**MA5 = 5-day Moving Average**

这是最常见、最标准的写法：

- **MA5**（技术分析图上常看到）
- **5-day Moving Average**
- **5-day Simple Moving Average（5-day SMA）** ← 更准确，因为是「简单移动平均」。

------

⭐ 专业写法区别（你未来会用到）

✔ **Simple Moving Average（SMA）**

简单算术平均
 你现在算的 MA5 就是 SMA5。

✔ **Exponential Moving Average（EMA）**

指数加权平均：
 近期价格权重更高，用 EMA5/EMA10 在量化策略很常见。

✔ **5-day MA**

一般官方报告、论文都会直接写成：

> “the 5-day moving average (MA5)”

------

🌤 一句话总结（你可以存档）

> **5日均线的英文是 “5-day Moving Average (MA5)” 或 “5-day Simple Moving Average (5-day SMA)”。**

------

如果你愿意，我可以顺手再告诉你——
 **MA5、MA10、MA20 在量化策略中分别代表怎样的“时间感知”和用途。**

🎯 **滚动窗口（rolling）为什么如此重要？**

因为它是所有时间序列分析的基础：

- MA（移动平均）
- 波动率（rolling std）
- 移动相关性（rolling corr）
- 移动最大最小值（rolling max/min）
- 指数平滑（ewm）
- 金融时间序列的平滑与去噪

几乎所有量化指标都基于“滑动窗口”。

🌤 **你要不要继续深入？我可以讲：**

1. **rolling(5).mean() 和 ewm(5).mean() 的区别**（SMA vs EMA）
2. 为什么量化策略更喜欢 EMA 而不是 MA
3. MA5、MA10、MA20 分别适合判断什么周期的趋势
4. 如何用 MA5 做“金叉、死叉策略”
